---
import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';
import { SITE_CONFIG } from '../constants/site';

const title = 'Kontakt - DTF Transfer Print';
const description = 'Kontaktieren Sie uns für Fragen, Beratung oder individuelle Anfragen. Wir helfen Ihnen gerne weiter.';
---

<Layout title={title} description={description}>
	<Navbar />

	<!-- Contact Section -->
	<section class="-mt-6 pt-14 pb-8 md:pt-18 md:pb-12 bg-base-100">
		<div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl">
			<div class="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-10">
				<!-- Contact Form -->
				<div class="order-2 lg:order-1">
					<div class="bg-white rounded-2xl shadow-sm border border-base-300/30 p-6 md:p-8">
						<h2 class="text-2xl md:text-3xl font-semibold text-neutral mb-2">Schreiben Sie uns</h2>
						<p class="text-neutral/60 mb-6 text-sm">Füllen Sie das Formular aus und wir melden uns schnellstmöglich bei Ihnen.</p>

						<form id="contact-form" class="space-y-4">
							<div class="form-control">
								<label class="label pb-2" for="name">
									<span class="label-text text-sm font-medium text-neutral/80">Name *</span>
								</label>
								<input
									type="text"
									id="name"
									name="name"
									required
									class="input input-bordered w-full bg-base-50 border-base-300/50 focus:border-primary focus:outline-none transition-all duration-200 h-12 text-base"
									placeholder="Ihr Name"
								/>
							</div>

							<div class="form-control">
								<label class="label pb-2" for="email">
									<span class="label-text text-sm font-medium text-neutral/80">E-Mail *</span>
								</label>
								<input
									type="email"
									id="email"
									name="email"
									required
									class="input input-bordered w-full bg-base-50 border-base-300/50 focus:border-primary focus:outline-none transition-all duration-200 h-12 text-base"
									placeholder="ihre@email.de"
								/>
							</div>

							<div class="form-control">
								<label class="label pb-2" for="phone">
									<span class="label-text text-sm font-medium text-neutral/80">Telefon</span>
								</label>
								<input
									type="tel"
									id="phone"
									name="phone"
									class="input input-bordered w-full bg-base-50 border-base-300/50 focus:border-primary focus:outline-none transition-all duration-200 h-12 text-base"
									placeholder="+49 123 456789"
								/>
							</div>

							<div class="form-control">
								<label class="label pb-2" for="subject">
									<span class="label-text text-sm font-medium text-neutral/80">Betreff *</span>
								</label>
								<select
									id="subject"
									name="subject"
									required
									class="select select-bordered w-full bg-base-50 border-base-300/50 focus:border-primary focus:outline-none transition-all duration-200 h-12 text-base"
								>
									<option value="">Bitte wählen Sie ein Thema</option>
									<option value="allgemein">Allgemeine Anfrage</option>
									<option value="beratung">Fachberatung</option>
									<option value="bestellung">Frage zur Bestellung</option>
									<option value="support">Technischer Support</option>
									<option value="b2b">B2B / Wiederverkäufer</option>
									<option value="sonstiges">Sonstiges</option>
								</select>
							</div>

							<div class="form-control">
								<label class="label pb-2" for="message">
									<span class="label-text text-sm font-medium text-neutral/80">Nachricht *</span>
								</label>
								<textarea
									id="message"
									name="message"
									required
									rows="6"
									class="textarea textarea-bordered w-full bg-base-50 border-base-300/50 focus:border-primary focus:outline-none transition-all duration-200 text-base resize-none"
									placeholder="Ihre Nachricht an uns..."
								></textarea>
							</div>

							<div class="form-control mt-6">
								<button type="submit" class="btn btn-primary btn-lg w-full h-12 text-base font-medium shadow-sm hover:shadow-md transition-all duration-200" id="submit-btn">
									<span class="loading loading-spinner loading-sm hidden" id="loading-spinner"></span>
									<span id="submit-text">Nachricht senden</span>
								</button>
							</div>

							<div id="form-message" class="hidden mt-4"></div>
						</form>
					</div>
				</div>

				<!-- Contact Information -->
				<div class="order-1 lg:order-2">
					<div class="sticky top-8">
						<div class="space-y-6">
							<div>
								<h2 class="text-2xl md:text-3xl font-semibold text-neutral mb-3">Kontaktinformationen</h2>
								<p class="text-sm text-neutral/70 mb-6">
									Unser Team steht Ihnen gerne zur Verfügung. Wählen Sie den für Sie passenden Kontaktweg.
								</p>
							</div>

							<!-- Contact Methods -->
							<div class="space-y-4">
								<!-- Email -->
								<a href="mailto:info@selini-shirt.de" class="flex items-start gap-3 p-4 rounded-xl bg-base-50 border border-base-300/30">
									<div class="flex-shrink-0 w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center">
										<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-primary">
											<path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" />
										</svg>
									</div>
									<div class="flex-1">
										<h3 class="font-semibold text-neutral mb-0.5 text-sm">E-Mail</h3>
										<p class="text-neutral/70 text-xs">info@selini-shirt.de</p>
									</div>
								</a>

								<!-- Phone -->
								<a href="tel:+49123456789" class="flex items-start gap-3 p-4 rounded-xl bg-base-50 border border-base-300/30">
									<div class="flex-shrink-0 w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center">
										<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-primary">
											<path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z" />
										</svg>
									</div>
									<div class="flex-1">
										<h3 class="font-semibold text-neutral mb-0.5 text-sm">Telefon</h3>
										<p class="text-neutral/70 text-xs">+49 123 456789</p>
									</div>
								</a>

								<!-- Office Hours -->
								<div class="flex items-start gap-3 p-4 rounded-xl bg-base-50 border border-base-300/30">
									<div class="flex-shrink-0 w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center">
										<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-primary">
											<path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
										</svg>
									</div>
									<div class="flex-1">
										<h3 class="font-semibold text-neutral mb-0.5 text-sm">Öffnungszeiten</h3>
										<p class="text-neutral/70 text-xs mb-1">Montag - Freitag: 9:00 - 18:00 Uhr</p>
										<p class="text-neutral/70 text-xs">Samstag: 10:00 - 14:00 Uhr</p>
									</div>
								</div>
							</div>

							<!-- Additional Info -->
							<div class="pt-4 border-t border-base-300/30">
								<p class="text-xs text-neutral/60">
									Für dringende Anfragen nutzen Sie bitte unser Kontaktformular oder rufen Sie uns direkt an. 
									Wir bemühen uns, alle Anfragen innerhalb von 24 Stunden zu beantworten.
								</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

	<script>
		const form = document.getElementById('contact-form') as HTMLFormElement;
		const submitBtn = document.getElementById('submit-btn') as HTMLButtonElement;
		const submitText = document.getElementById('submit-text') as HTMLSpanElement;
		const loadingSpinner = document.getElementById('loading-spinner') as HTMLSpanElement;
		const formMessage = document.getElementById('form-message') as HTMLDivElement;

		form.addEventListener('submit', async (e) => {
			e.preventDefault();

			// Reset message
			formMessage.classList.add('hidden');
			formMessage.classList.remove('alert-success', 'alert-error');

			// Disable submit button and show loading
			submitBtn.disabled = true;
			submitText.textContent = 'Wird gesendet...';
			loadingSpinner.classList.remove('hidden');

			try {
				const formData = new FormData(form);
				const data = Object.fromEntries(formData);

				const response = await fetch('/api/contact', {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json',
					},
					body: JSON.stringify(data),
				});

				const result = await response.json();

				if (response.ok) {
					// Success
					formMessage.classList.add('alert', 'alert-success');
					formMessage.innerHTML = `
						<svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
						</svg>
						<span>${result.message || 'Ihre Nachricht wurde erfolgreich gesendet. Wir melden uns schnellstmöglich bei Ihnen.'}</span>
					`;
					formMessage.classList.remove('hidden');
					form.reset();
				} else {
					// Error
					formMessage.classList.add('alert', 'alert-error');
					formMessage.innerHTML = `
						<svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
						</svg>
						<span>${result.error || 'Ein Fehler ist aufgetreten. Bitte versuchen Sie es erneut oder kontaktieren Sie uns direkt.'}</span>
					`;
					formMessage.classList.remove('hidden');
				}
			} catch (error) {
				// Network or other error
				formMessage.classList.add('alert', 'alert-error');
				formMessage.innerHTML = `
					<svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
					</svg>
					<span>Verbindungsfehler. Bitte überprüfen Sie Ihre Internetverbindung und versuchen Sie es erneut.</span>
				`;
				formMessage.classList.remove('hidden');
			} finally {
				// Re-enable submit button
				submitBtn.disabled = false;
				submitText.textContent = 'Nachricht senden';
				loadingSpinner.classList.add('hidden');
			}
		});
	</script>
</Layout>
