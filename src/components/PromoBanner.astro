---
// Promotional banner with scrolling marquee text
import { settingsCache } from '../lib/settings-cache';

// Use cached settings - only queries database when cache expires (every 5 minutes)
const bannerSettings = await settingsCache.getBannerSettings();
const bannerEnabled = bannerSettings.enabled;
const bannerText = bannerSettings.text;
---

{bannerEnabled && (
	<div class="promo-banner-container w-full">
		<div class="promo-banner text-neutral-content py-2 overflow-hidden">
			<div class="marquee-wrapper">
				<div class="marquee-content">
					{Array(10).fill(null).map(() => (
						<span class="marquee-text">{bannerText}</span>
					))}
				</div>
				<div class="marquee-content" aria-hidden="true">
					{Array(10).fill(null).map(() => (
						<span class="marquee-text">{bannerText}</span>
					))}
				</div>
			</div>
		</div>
	</div>
)}

<style>
	.promo-banner-container {
		position: relative;
		z-index: 70;
	}

	.promo-banner {
		position: relative;
		background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
	}

	.marquee-wrapper {
		display: flex;
		overflow: hidden;
		user-select: none;
		width: 100%;
	}

	.marquee-content {
		display: flex;
		flex-shrink: 0;
		animation: scroll 30s linear infinite;
		gap: 0;
		min-width: 100%;
	}

	.marquee-text {
		display: inline-block;
		padding: 0 4rem;
		white-space: nowrap;
		font-size: 0.875rem;
		font-weight: 500;
		letter-spacing: 0.025em;
		flex-shrink: 0;
	}

	@keyframes scroll {
		from {
			transform: translateX(0);
		}
		to {
			transform: translateX(-100%);
		}
	}

	/* Pause animation on hover */
	.marquee-wrapper:hover .marquee-content {
		animation-play-state: paused;
	}

	/* Responsive font sizes */
	@media (max-width: 640px) {
		.marquee-text {
			font-size: 0.75rem;
			padding: 0 2rem;
		}
	}

	@media (min-width: 641px) and (max-width: 1024px) {
		.marquee-text {
			font-size: 0.8125rem;
			padding: 0 3rem;
		}
	}
</style>
